<!DOCTYPE html>
 <html lang="cs">
 <link rel="icon" href="https://img41.rajce.idnes.cz/d4102/19/19244/19244630_db82ad174937335b1a151341387b7af2/images/image_82x82.jpg?ver=1" type="image/png">

 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Star Trek: HudebnÃ­ PÅ™ehravaÄ</title>
      
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="miniPlayer.css">  
   
  <link rel="stylesheet" href="casovac.css"> 
   
  <link rel="stylesheet" href="browser-status.css">   
  <link rel="stylesheet" href="scrollbar.css"> 
  <link rel="stylesheet" href="christmas.css"> 
  <link rel="stylesheet" href="zobrazit-panel-hlasitosti.css">
 
  
</head>
<body>
   
    
    <div id="browser-status" class="ukazatel">
    <span style="color: #ff00ff;"> </span> 
    <strong> </strong> 
    <span id="browser-info" style="color: #ffff00; font-weight: bold;"></span>
</div>
 <div class="player-content-wrapper">
        
    
     
  <div class="background-image-container">
   <img src="">
  </div>
  
  
    
     <audio id="audioPlayer">
    <source id="audioSource" src="" type="audio/mpeg">
</audio>


  <div class="player-container">
       
      <h1 class="header-title" id="nazev-prehravace" >STAR TREK: HUDEBNÃ PÅ˜EHRAVAÄŒ</h1>
    <h2 id="trackTitle">Vyberte skladbu</h2>
      
      
      <div class="time-controls" id="progres-bar-time-part" >
        <span id="currentTime" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
         <span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span>
        </span>
        <input type="range" id="progress-bar" min="0" max="100" value="0" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
        <span id="duration" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
          <span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span>
        </span>
      </div>
      
     <!-- obal/pouzdro-->
      <div id="control-panel" >
           <!-- hl kontejner tlaÄÃ­tek -->
        <div class="controls">
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="prev-button" title="PÅ™edchozÃ­ (Å ipka vlevo)"  >â—€ï¸â¬…ï¸</button> 
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="play-button" title="PÅ™ehrÃ¡t (MezernÃ­k/P)"   >ğŸš€</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="pause-button" title="Pauza (MezernÃ­k/P)"  >ğŸ––â¸ï¸</button>
        <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="next-button" title="DalÅ¡Ã­ (Å ipka vpravo)"  >â–¶ï¸â¡ï¸</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="loop-button" title="Opakovat (L)"  >ğŸ”</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="shuffle-button" title="NÃ¡hodnÄ› (Vypnuto)"  >ğŸ”€</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="reset-button" title="Restartovat skladbu (R)"  >ğŸ”„</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="fullscreen-toggle" title="CelÃ¡ obrazovka (F)"  >â›¶</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="toggle-info-button" title="Zobrazit/SkrÃ½t klÃ¡vesovÃ© zkratky"   >ğŸ“‹</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="reload-button" title="Obnovit strÃ¡nku"  >ğŸ”„</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="toggle-playlist-button" title="Zobrazit/SkrÃ½t playlist"  >ğŸ“œ</button> 
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="timer-button" title="ÄŒasovaÄ vypnutÃ­ (T)"  >â°</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="clearAllDataBtn" onclick="window.clearAllAudioPlayerData()"  >ğŸ—‘ï¸</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="perf-monitor-btn">ğŸ”ğŸ“Š</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
           <button id="jirik-manual-opener-btn"  >ğŸ§¾</button>  
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
          <button id="mini-mode-float">ğŸ–¼ï¸ Float</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
<button id="mini-mode-pip">ğŸ“º PiP</button>
            <!-- MÃ¡m nastaveno v buttonVisibilityManager.js-->
<button id="mini-mode-popup">ğŸªŸ Popup</button>
 
            
    <!-- budu nastavovat v buttonVisibilityManager.js-->        
  <!-- JednoduchÃ© PTT tlaÄÃ­tko -->
<button class="voice-ptt-trigger" id="voice-commands-help">V</button> 
<button class="control-button" onclick="window.voiceController.showHelp()" title="Zobrazit hlasovÃ© pÅ™Ã­kazy (ManuÃ¡l)" id="zobrazeni-manualu">ğŸ“‹</button>          
 <button id="debug-manager-button">ğŸ› ï¸ DIAGNOSTIKA</button>  
 <button id="bluetooth-monitor-toggle">ğŸ› ï¸ </button>           
 <button id="uprava-barev-moldar-system" title="zobrazit moldar">ğŸ¨ UI</button>           
 <button id="zobrazit-panel-hlasitosti" title="panel-hlasitost">ğŸ”ŠğŸ“‹</button>      
         <button id="install-app-button" class="control-button" title="Instalovat aplikaci do systÃ©mu">ğŸ“¥ INSTALOVAT</button>
            
   <button id="playlist-sync-button" title="playlist-syn">ğŸ”„ğŸ“‹</button>         
    <button id="lehka-atomovka" title="lehkÃ¡ atomovka">â˜¢ï¸</button>        
             
        </div>
       
          
        <div class="volume-controls" id="volume-sider-nastaveni-hlasitosti" >
          <button id="mute-button" title="Ztlumit (M)">ğŸ”Š</button>
          <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.1" title="Hlasitost (A/D)">
          <span id="volume-value">10</span>
        </div>
      </div>
      <div class="performance-mode" id="perfMode">âš¡ VARIANTA B</div>
      <div id="search-container" class="search-container">
    <div class="search-input-wrapper" >
        <input  
            type="text" 
            id="search-input" 
            class="search-input" 
            placeholder="ğŸ” Hledat skladbu... (Ctrl+F)"
            autocomplete="off"
        />
        <button id="clear-search" class="clear-search-button" style="display: none;">âœ–</button>
    </div>
    <div id="search-counter" class="search-counter" style="display: none;"></div>
    <div id="search-results" class="search-results" style="display: none;"></div>
</div>

      <div class="playlist" id="playlist" style="display: block; "> 
          
    <div id="notification"></div>
      <div class="fade-indicator">       
   

  </div>
      </div>
    </div> 
 <div class="hlavni-kontejner-pro-cas-a-casovac" id="digitalni-hodini-datum">
  <div class="time-calendar-wrapper">
    <div class="time">
      <div class="time-colon"><div class="time-text"><span class="num hours">00</span><span class="text">H</span></div></div>
      <span class="colon">:</span>
      <div class="time-colon"><div class="time-text"><span class="num minutes">00</span><span class="text">M</span></div></div>
      <span class="colon">:</span>
      <div class="time-colon"><div class="time-text"><span class="num seconds">00</span><span class="text">S</span></div></div>
    </div>
    <div class="calendar"><div class="date" id="currentDate"></div></div>
  </div>

  <div class="timer-container" id="timer-container">
    <div class="timer-display">
      <span id="timer-minutes">00</span>:<span id="timer-seconds">00</span> 
    </div>
    
    <div class="timer-controls">
      <!-- VstupnÃ­ pole pro minuty -->
      <input 
        type="number" 
        id="timer-input" 
        placeholder="Zadej minuty" 
        min="1"
        value="15"
      />
      
      <!-- OvlÃ¡dacÃ­ tlaÄÃ­tka -->
      <button id="timer-start">â–¶ï¸ Start</button>
      <button id="timer-stop">â¹ï¸ Stop</button>
      <button id="timer-reset">ğŸ”„ Reset</button>
    </div>
  </div>
</div>
        <!-- MÃ¡m nastaveno v buttonVisibilityManager.js >> pouze jen id popisky to mi skrÃ½vÃ¡ celÃ½ tento blok aÅ¾ po <canvas id="waveform-canvas"></canvas> -->
     <div class="keyboard-container">
    <div id="popisky"> 
        
      </div>
         
       </div>
    <footer>
      &copy; <span id="currentYear"  ></span> Star Trek: HudebnÃ­ PÅ™ehravaÄ | VytvoÅ™eno s lÃ¡skou ke Star Treku
    </footer>
          
   </div>
  <!-- ============================================ -->
<!-- ğŸ–– STAR TREK AUDIO PLAYER - MODULE LOADING ORDER -->
<!-- Verze: 3.5 - OptimalizovanÃ© poÅ™adÃ­ pro Firebase -->
<!-- ============================================ -->
  
<!-- ============================================ -->
<!-- LAYER 0: PWA FLEET REGISTRY (MUSÃ BÃT PRVNÃ!) -->
<!-- ============================================ -->
  <script src="fleet-register.js"></script>

<!-- ============================================ -->
<!-- LAYER 1: FIREBASE CORE (SYNCHRONNÃ - BEZ DEFER!) -->
<!-- MusÃ­ se naÄÃ­st PÅ˜ED vÅ¡emi Firebase moduly -->
<!-- ============================================ -->
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

<!-- ============================================ -->
<!-- LAYER 2: DEBUG & LOGGING (SYNCHRONNÃ - BEZ DEFER!) -->
<!-- MusÃ­ bÃ½t PÅ˜ED Firebase moduly, aby mohly logovat -->
<!-- ============================================ -->
<script src="DebugManager.js"></script>

<!-- ============================================ -->
<!-- LAYER 3: FIREBASE MODULY (SYNCHRONNÃ - BEZ DEFER!) -->
<!-- PoskytujÃ­ API pro ostatnÃ­ moduly -->
<!-- ============================================ -->
 

<!-- ============================================ -->
<!-- LAYER 4: CORE AUDIO ENGINE (SYNCHRONNÃ - BEZ DEFER!) -->
 <!--    <script src="stream_stabilizer.js"></script> -->

<!-- Inicializuje window.tracks, window.favorites, audio element -->
<!-- ============================================ -->
<script type="module" src="script.js"></script>
 <script type="module" src="audioFirebaseFunctions.js"></script>   
    <script src="playlistSync.js" ></script>
  <script src="pokrocila-sprava-playlistu.js" defer></script>   
<script src="buttonVisibilityFirebase.js"></script>
<script src="playlist-height.js"  ></script>  <!-- PÅ˜ED -->
  
<!-- ============================================ -->
<!-- LAYER 5: DATA LAYER (SYNCHRONNÃ - BEZ DEFER!) -->
<!-- KRITICKÃ‰: myPlaylist.js MUSÃ bÃ½t BEZ DEFER! -->
<!-- audioFirebaseFunctions.js ÄekÃ¡ na window.PLAYLIST_SOURCE_READY -->
<!-- ============================================ -->
<script src="myPlaylist.js"></script>

<!-- ============================================ -->
<!-- LAYER 6: UI MANAGERS (SYNCHRONNÃ nebo DEFER podle zÃ¡vislostÃ­) -->
<!-- SprÃ¡va pozadÃ­, barev, notifikacÃ­ -->
<!-- ============================================ -->
<script src="backgroundManager.js"></script>
<script src="colorManager.js"></script>
<script src="notificationFix.js" defer></script>

<!-- ============================================ -->
<!-- LAYER 7: SYNC & STORAGE (DEFER OK) -->
<!-- Synchronizace playlistu s cloudem -->
<!-- ============================================ -->
 
<!-- ============================================ -->
<!-- LAYER 8: FEATURE MODULY (DEFER nebo ASYNC) -->
<!-- RozÅ¡iÅ™ujÃ­cÃ­ funkce - mÅ¯Å¾ou se naÄÃ­st paralelnÄ› -->
<!-- ============================================ -->

<!-- PokroÄilÃ¡ sprÃ¡va playlistu -->
 

<!-- NastavenÃ­ vzhledu playlistu -->
<script src="playlistSettings.js" defer></script>

<!-- SprÃ¡va viditelnosti tlaÄÃ­tek -->
<script src="buttonVisibilityManager.js" defer></script>

<!-- AutomatickÃ© pÅ™echody mezi skladbami -->
<script src="autoFade.js" defer></script>

<!-- ÄŒasovaÄ -->
<script src="timer-module.js" defer></script>

<!-- VyhledÃ¡vaÄ skladeb -->
<script src="vyhledavac-skladeb.js" defer></script>

<!-- Mini pÅ™ehrÃ¡vaÄ (plovoucÃ­ okno) -->
<script src="miniPlayer.js" defer></script>

<!-- ============================================ -->
<!-- LAYER 9: MONITORING & DEBUG (DEFER nebo ASYNC) -->
<!-- MonitorovacÃ­ nÃ¡stroje - nejniÅ¾Å¡Ã­ priorita -->
<!-- ============================================ -->
<script src="universalni-perfomens-monitor.js" defer></script>
<script src="jirkuv-hlidac.js" defer></script>
<script src="bluetoothDisconnectMonitor.js" defer></script>

<!-- ============================================ -->
<!-- LAYER 10: UI FINALIZATION (DEFER - POSLEDNÃ!) -->
<!-- FinÃ¡lnÃ­ Ãºpravy UI - musÃ­ bÃ½t po vÅ¡ech feature modulech -->
<!-- ============================================ -->
<script src="sprava-rozhrani.js" defer></script>
<script src="scrollbar.js" defer></script>

<!-- ============================================ -->
<!-- LAYER 11: PWA INSTALLER (SYNC nebo DEFER) -->
<!-- Instalace PWA aplikace -->
<!-- ============================================ -->
 <script src="lehka-atomovka.js"></script>  

<!-- ============================================ -->
<!-- ğŸ–– KONEC NAÄŒÃTÃNÃ MODULÅ® -->
<!-- VÃ­ce admirÃ¡l JiÅ™Ã­k & AdmirÃ¡l Claude.AI -->
<!-- ============================================ -->
 <script>
    (function() {
        // 1. ZLIKVIDOVAT DUCHY (StarÃ© Service Workery)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) registration.unregister();
            });
        }

        // 2. KONTROLA ÄŒERSTVOSTI (Bez spuÅ¡tÄ›nÃ­ kÃ³du)
        // StÃ¡hneme text souboru ze serveru s unikÃ¡tnÃ­m ÄasovÃ½m razÃ­tkem
        fetch('fleet-register.js?check=' + new Date().getTime())
            .then(response => response.text())
            .then(text => {
                // Najdeme verzi v novÃ©m souboru (hledÃ¡me text 'version: "..."')
                var match = text.match(/version:\s*"([^"]+)"/);
                
                if (match && match[1]) {
                    var serverVerze = match[1];
                    // ZÃ­skÃ¡me aktuÃ¡lnÃ­ verzi, kterou mÃ¡ prohlÃ­Å¾eÄ v pamÄ›ti
                    // (Pokud FLEET_CONFIG jeÅ¡tÄ› neexistuje, je to starÃ¡ cache nebo chyba)
                    var browserVerze = (window.FLEET_CONFIG) ? window.FLEET_CONFIG.version : "0.0.0";

                    console.log("ğŸ• [Watchdog] Server: " + serverVerze + " | ProhlÃ­Å¾eÄ: " + browserVerze);

                    // POKUD SE VERZE LIÅ Ã -> TVRDÃ RELOAD
                    if (serverVerze !== browserVerze) {
                        console.warn("âš ï¸ [Watchdog] ZastaralÃ¡ cache detekovÃ¡na! ProvÃ¡dÃ­m tvrdÃ½ restart...");
                        // Toto donutÃ­ prohlÃ­Å¾eÄ zahodit cache a naÄÃ­st strÃ¡nku znova
                        window.location.reload(true);
                    } else {
                        console.log("âœ… [Watchdog] Verze souhlasÃ­. SystÃ©m je aktuÃ¡lnÃ­.");
                    }
                }
            })
            .catch(err => console.log("ğŸ• [Watchdog] Kontrola selhala (asi offline):", err));
    })();
</script>

</body>
</html>











